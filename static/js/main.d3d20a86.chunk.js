(this["webpackJsonpshakepay-interview-web"]=this["webpackJsonpshakepay-interview-web"]||[]).push([[0],{177:function(t,e,n){"use strict";n.r(e);var a=n(5),r=n.n(a),o=n(50),i=n.n(o),c=(n(59),n.p,n(60),n(14)),s=n(51),l=n(54),u=n(53),h=n(52),g=n(25),T=n.n(g),d=function t(){Object(c.a)(this,t)};d.transactionHistoryEndpoint="https://shakepay.github.io/programming-exercise/web/transaction_history.json",d.exchangeRateEndpoint="https://shakepay.github.io/programming-exercise/web/rates_CAD_BTC.json",d.getTransactionData=function(t){return T()({method:"get",url:t})},d.getExchangeRate=function(t){return T()({method:"get",url:"https://shakepay.github.io/programming-exercise/web/rates_CAD_".concat(t,".json")})};var f=d,b={CAD_BTC:1502e-8,BTC_CAD:66566.3,CAD_ETH:.000428285811176005,ETH_CAD:2334.88,USD_BTC:1907e-8,BTC_USD:52420.81,USD_ETH:.000543856595892794,ETH_USD:1838.72,BTC_ETH:28.506271379703534,ETH_BTC:.03508,CAD_USD:.78,USD_CAD:1.26},v=n(1),C=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).getTransactions=function(){f.getTransactionData(f.transactionHistoryEndpoint).then((function(t){console.log({transactionHistoryResponse:t});var e=t.data;e.sort((function(t,e){return new Date(t.createdAt)-new Date(e.createdAt)})),console.log({transactions:e}),a.setState({transactions:e},(function(){a.calculateBalances()}))}))},a.calculateBalances=function(){var t=a.state,e=t.transactions,n=t.useTransactionTimeExchangeRate,r=[];e.forEach((function(t,e){var n,a,o;0===r.length?(n={CAD:0,BTC:0,ETH:0},console.log("first previousBalances",n)):n=r[e-1].balances,0===e&&(console.log({netWorthHistory:r,transaction:t,previousBalances:n}),console.log("netWorthHistory.length",r.length));var i=Object.assign({},n);a=t.createdAt,"conversion"===t.type?(i[t.from.currency]=n[t.from.currency]-t.from.amount,i[t.to.currency]=n[t.to.currency]+t.to.amount):(o="credit"===t.direction?t.amount:-1*t.amount,i[t.currency]=n[t.currency]+o);var c={balances:i,date:a};r.push(c)})),console.log({netWorthHistory:r}),a.setState({netWorthHistory:r},(function(){a.calculateNetWorth(n)}))},a.calculateDailyNetWorth=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];a.state.netWorthHistory;if(t){var e=a.state,n=e.BTCRatesOverTime,r=e.ETHRatesOverTime;0===n.length||0===r.length?f.getExchangeRate("BTC").then((function(t){console.log({BTCResponse:t}),a.setState({BTCRatesOverTime:t.data},(function(){f.getExchangeRate("ETH").then((function(t){console.log({ETHResponse:t}),a.setState({ETHRatesOverTime:t.data}),a.calculateDailyNetWorth(!0)}))}))})):a.calculateDailyNetWorth(!0)}else a.calculateDailyNetWorth(!1)},a.getExchangeRatesOnGivenDay=function(t){for(var e=a.state,n=e.BTCRatesOverTime,r=e.ETHRatesOverTime,o={BTC_CAD:"",ETH_CAD:""},i=t.date.substring(0,10),c=0;c<n.length;c++){if(i===n[c].createdAt.substring(0,10)){o.BTC_CAD=n[c].midMarketRate;break}}for(c=0;c<r.length;c++){if(i===r[c].createdAt.substring(0,10)){o.ETH_CAD=r[c].midMarketRate;break}}return o},a.convertBalancesToFiat=function(t,e){return t.CAD+t.BTC*e.BTC_CAD+t.ETH*e.ETH_CAD},a.calculateNetWorth=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=a.state.netWorthHistory;e.forEach((function(e){var n;if(t){var r=a.getExchangeRatesOnGivenDay(e);n=a.convertBalancesToFiat(e.balances,r)}else n=a.convertBalancesToFiat(e.balances,b);e.netWorth=n})),a.setState({netWorthHistory:e})},a.state={transactions:[],BTCRatesOverTime:[],ETHRatesOverTime:[],netWorthHistory:[],useTransactionTimeExchangeRate:!0},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.getTransactions()}},{key:"render",value:function(){var t=this.state.netWorthHistory,e={labels:t.map((function(t){return t.date})),datasets:[{label:"Net Worth",fill:!1,lineTension:.1,backgroundColor:"rgba(75,192,192,0.4)",borderColor:"rgba(75,192,192,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:t.map((function(t){return t.netWorth}))}]};return Object(v.jsxs)("div",{children:[Object(v.jsx)("h2",{children:"Net Worth"}),Object(v.jsx)(h.Line,{data:e})]})}}]),n}(r.a.Component);var p=function(){return Object(v.jsx)("div",{className:"App",children:Object(v.jsx)(C,{})})},y=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,178)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,o=e.getLCP,i=e.getTTFB;n(t),a(t),r(t),o(t),i(t)}))};i.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(p,{})}),document.getElementById("root")),y()},59:function(t,e,n){},60:function(t,e,n){}},[[177,1,2]]]);
//# sourceMappingURL=main.d3d20a86.chunk.js.map